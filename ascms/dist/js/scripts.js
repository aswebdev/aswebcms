$(document).ready(function(){function a(a){""!=a?($(".popup-msg").html('<div class="alert alert-danger" style="margin-top:10px;"><button type="button" class="close" data-dismiss="alert">&times;</button>'+a+"</div>"),setTimeout(function(){b()},500)):$(".admin-form").submit()}function b(){0==i&&($(".popup-msg").fadeIn(320),i=1)}function c(){0==j&&($("#searchPopup").fadeIn(320),$("#backgroundPopup").css("opacity","0.7"),$("#backgroundPopup").fadeIn(1),j=1)}function d(){(1==i||1==j)&&($("#toPopup").fadeOut("normal"),$("#searchPopup").fadeOut("normal"),$("#backgroundPopup").fadeOut("normal"),i=0,j=0)}function e(a,b,c,d){if(!c.name.match(/\.(jpg|jpeg|png|gif)$/))return a.html("<strong>Error:</strong> Use jpeg, png or gif format!"),setTimeout(function(){b.trigger("dragleave")},2e3),!1;b.css("background","#fff");var e=new FileReader;e.readAsDataURL(c),e.onprogress=function(){a.html('<img src="dist/img/loader.gif">')},e.onload=function(c){a.html(""),b.append('<div class="uploaded-img"><img src="'+c.target.result+'" style="max-height:148px;max-width:148px;" ><div class="upload-area-filled"><a href="javascript:;" title="remove">x</a></div></div>');var e=("data="+c.target.result+"&filename="+d,new FormData);e.append("data",c.target.result),e.append("filename",d),f("ajax/save-file.php",e,function(){var a=b.data("field"),c=document.getElementsByClassName("admin-form")[0],e=document.createElement("input");e.setAttribute("type","hidden"),e.setAttribute("name",a),e.setAttribute("value",d),c.appendChild(e)}),l=!0}}function f(a,b,c){var d=new XMLHttpRequest;d.onload=function(a){c!==!1&&c(a)},d.open("POST",a,!0),d.send(b)}function g(a){var b={"image/jpeg":"jpeg","image/png":"png"};return b[a]?b[a]:!1}function h(a){for(var b="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",c="",d=a;d>0;--d)c+=b[Math.round(Math.random()*(b.length-1))];return c}$(".fancybox").length>0&&$(".fancybox").fancybox();var i=0,j=0;""!=$("#updateMsg").html()&&($("#updateMsg").css("display","block"),setTimeout(function(){$("#updateMsg").animate({opacity:1},500,function(){setTimeout(function(){$("#updateMsg").animate({opacity:0},500,function(){$("#updateMsg").css("display","none")})},2e3)})},200)),$(".pageReload").change(function(){pageReload=$(this).val(),document.location=pageReload});var k="",l=!1;$(".upload-area").on("dragover",function(a){a.preventDefault(),""==k&&(k=$(this).html()),$(this).children("span").html('<strong class="drop-file"><i class="fa fa-check"></i>&nbsp;&nbsp;Drop Now!</strong>')}).on("drop",function(a){a.preventDefault();var b=$(this).children("span"),c=$(this),d=h(32)+"."+g(a.originalEvent.dataTransfer.files[0].type);e(b,c,a.originalEvent.dataTransfer.files[0],d),$(this).children("span").html(this.dropMsg)}).on("dragleave",function(a){a.preventDefault(),$(this).css("background","#fff"),$(this).html(k)}),$(document).on("click",".upload-area-filled a",function(){var a=$(this).parents(".upload-area"),b=a.data("field");a.html(k),b=document.getElementsByName(b)[0],b.parentNode.removeChild(b),l=!1}),$(".upload-area").on("click",function(){var a=$(this).children("span"),b=$(this),c=h(32);if(""==k&&(k=$(this).html()),0==l){var d=document.createElement("input");d.type="file",d.name="file-upload",d.setAttribute("class","upload-hidden"),d.id="file-upload",document.getElementsByClassName("admin-form")[0].appendChild(d),d.addEventListener("change",function(d){var f=g(d.target.files[0].type);c=c+"."+f,e(a,b,d.target.files[0],c)}),d.click()}}),$(".searchButton").click(function(){return c(),!1}),$(".searchButton").mouseover(function(){$("#searchText").fadeIn("500")}),$(".searchButton").mouseout(function(){$("#searchText").fadeOut("500")}),$(".logoutButton").mouseover(function(){$("#logoutText").fadeIn("500")}),$(".logoutButton").mouseout(function(){$("#logoutText").fadeOut("500")}),$(".requiredElement").focus(function(){"rgb(255,255,255)"!=$(this).css("backgroundColor")&&$(this).css("backgroundColor","rgb(255,255,255)")}),$(".submitButton").click(function(){var b="";$(".requiredElement").each(function(){""==$(this).val()&&(b+=$(this).data("error")+"<br />\n")}),$(".uploadImg").each(function(){if(""!=$(this).val()){var a=$(this).val().toLowerCase(),c=a.split("."),d=c[1],e=!1,f=$(this).data("filetype"),g=f.split("|"),h="";$.each(g,function(){h+=this+", ",-1!==this.indexOf(d)&&(e=!0)}),h=h.substring(0,h.length-2),0==e&&(b+="File Upload for <strong>"+$(this).data("label")+"</strong> is not a supported file type. The file must be "+h+"<br />\n")}}),""!=b&&(b="<strong>Please fix the following errors!</strong><br />"+b),a(b)}),$(".deleteButton").click(function(){confirm("Are you sure you want to Delete?")&&($("<input>").attr({type:"hidden",name:"deleteEntry",value:"true"}).appendTo("form"),$(".admin-form").submit())}),$("#searchPages").change(function(){$(".searchTerm").trigger("keyup")}),$("#searchProducts").change(function(){$(".searchTerm").trigger("keyup")}),$("#searchCustomers").change(function(){$(".searchTerm").trigger("keyup")}),$("#searchOrders").change(function(){$(".searchOrders").trigger("keyup")}),$(".searchTerm").keyup(function(){var a="ajax/search-results.php",b=$(this).val(),c="",d="",e="",f="";b.length>3?($("#searchResults").html('<img src="includes/img/dest/ajax-loader-blue.gif" border="0" />'),1==$("#searchProducts").prop("checked")&&(c="1"),1==$("#searchPages").prop("checked")&&(d="1"),1==$("#searchCustomers").prop("checked")&&(f="1"),1==$("#searchOrders").prop("checked")&&(e="1"),dataString={searchTerm:b,searchProducts:c,searchPages:d,searchCustomers:f,searchOrders:e},$("#searchResults").load(a,dataString)):$("#searchResults").html("")}),$(".removeItem").click(function(){var a=$(this),b=confirm("Are you Sure you want to Remove this item?"),c=$(this).data("remove"),d=$(this).data("details");1==b&&(dataString={fileItem:c,fileDetails:d},$.getJSON("ajax/remove-item.php",dataString,function(b){console.log(b),"VALID"==b.RETURN&&a.hide(500)}))}),$("#backgroundPopup").click(function(){d()})});